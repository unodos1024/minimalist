<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>심플하게 산다 (L'Art de la Simplicité)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@200;400;700&family=Outfit:wght@100;300;400;600&display=swap"
        rel="stylesheet">
    <meta name="theme-color" content="#FFFFFF">
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('Service Worker: Registered (Scope: ' + reg.scope + ')'))
                    .catch(err => console.log('Service Worker: Error ' + err));
            });
        }
    </script>
</head>

<body>
    <div class="app-container">
        <div id="clutter-layer"></div>
        <div class="theme-toggle" id="theme-btn" onclick="toggleTheme()" style="display: none;" data-i18n="toggle_mode">
            자정 모드</div>

        <div class="lang-selector" id="lang-btn" style="display: none;">
            <span class="lang-item" onclick="applyLanguage('ko')">KO</span>
            <span class="lang-item" onclick="applyLanguage('en')">EN</span>
            <span class="lang-item" onclick="applyLanguage('fr')">FR</span>
            <span class="lang-item" onclick="applyLanguage('es')">ES</span>
            <span class="lang-item" onclick="applyLanguage('ja')">JA</span>
        </div>

        <div class="back-btn" id="global-back-btn" onclick="goToScreen('home')" data-i18n="nav_close">← 닫기</div>

        <div id="screen-splash" class="screen active" onclick="goToScreen('home')">
            <div class="splash-title" data-i18n="title">단순함</div>
            <div class="splash-start" data-i18n="splash_start">시작하려면 터치하세요</div>
        </div>

        <div id="screen-home" class="screen">
            <div style="flex: 1; display: flex; flex-direction: column; justify-content: center; width: 100%;">
                <button class="btn-link" onclick="goToScreen('question')" data-i18n="home_question">오늘의 질문</button>
                <button class="btn-link" onclick="goToScreen('timer')" data-i18n="home_timer">공간 비우기</button>
                <button class="btn-link" onclick="goToScreen('pause')" data-i18n="home_pause">의도적 멈춤</button>
                <button class="btn-link" onclick="goToScreen('journey')" data-i18n="home_journey"
                    style="color:var(--accent-color); font-size: 1.1rem; margin-top: 30px;">30일 비움 여정</button>
            </div>
            <div
                style="margin-top: auto; padding-bottom: 30px; display: flex; flex-direction: column; align-items: center; gap: 40px; width: 100%;">
                <div id="wisdom-quote"
                    style="font-size: 0.9rem; color: var(--text-muted); font-style: italic; line-height: 1.8; max-width: 260px; font-weight: 200; opacity: 0.7;">
                </div>

                <div class="home-widget" onclick="goToScreen('archive')"
                    style="cursor: pointer; border-top: 1px solid var(--border-color); padding-top: 25px; width: 80%; max-width: 250px;">
                    <div class="widget-label" style="font-size: 0.55rem; letter-spacing: 0.5em; margin-bottom: 8px;"
                        data-i18n="home_archive">Archive</div>
                    <div class="widget-content" id="widget-stat-summary" style="font-size: 0.75rem;">0.0 KG RELEASED
                    </div>
                </div>
            </div>
        </div>

        <div id="screen-journey" class="screen">
            <div class="small-label" data-i18n="home_journey">30일 비움 여정</div>
            <div id="journey-day-label"
                style="font-size: 3rem; font-weight: 100; margin-bottom: 20px; font-family: var(--font-sans);">DAY 1
            </div>
            <div id="journey-card"
                style="border: 1px solid var(--border-color); padding: 40px 20px; margin: 20px 0; width: 100%; max-width: 100%; transition: var(--transition);">
                <div id="journey-text"
                    style="font-size: 1.2rem; line-height: 1.6; word-break: keep-all; overflow-wrap: break-word;"></div>
            </div>

            <div id="journey-status" style="margin: 20px 0; color: var(--text-muted); font-size: 0.8rem;"></div>

            <button class="btn-link" id="btn-complete-journey" onclick="completeJourney()" style="margin-top: 30px;"
                data-i18n="btn_complete">완료하기</button>

            <div style="margin-top: 50px; display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; max-width: 280px;"
                id="journey-map">
                <!-- Dots generated by JS -->
            </div>
        </div>

        <div id="screen-question" class="screen">
            <div class="small-label" data-i18n="label_reflection">성찰의 시간</div>
            <div id="q-text" class="question-text"></div>
            <input type="text" id="q-input" class="input-line" data-i18n-placeholder="input_placeholder"
                placeholder="마음의 답을 입력하세요" onkeypress="handleQuestion(event)">
            <div onclick="refreshQuestion()"
                style="margin-top: 40px; font-size: 0.75rem; color: var(--text-dim); cursor: pointer; letter-spacing: 0.1em;"
                data-i18n="next_question">다른 질문 보기</div>
        </div>

        <div id="screen-timer" class="screen">
            <div id="timer-ritual"
                style="width: 100%; display: flex; flex-direction: column; align-items: center; position: relative;">
                <div class="small-label" data-i18n="label_timer" style="margin-bottom: 40px; z-index: 10;">비우는 시간</div>

                <!-- Breathing Circle -->
                <div id="breathing-circle"></div>

                <div class="timer-display" id="timer-val" style="margin: 0 0 20px 0; z-index: 10;">10:00</div>
                <div id="timer-prompt" data-i18n="timer_prompt"
                    style="font-size:0.9rem; font-style:italic; font-weight:200; color:var(--text-muted); min-height:1.5em; z-index: 10;">
                    시작 버튼을 눌러 비움을 준비하세요.</div>
                <button class="btn-link" id="timer-btn" onclick="toggleTimer()" data-i18n="timer_start"
                    style="margin: 40px 0; font-size: 1.6rem; z-index: 10;">시작하기</button>
                <div class="ambient-selector" style="z-index: 10;">
                    <div class="ambient-btn active" onclick="setAmbient('none', this)" data-i18n="ambient_none">침묵</div>
                    <div class="ambient-btn" onclick="setAmbient('wind', this)" data-i18n="ambient_wind">바람</div>
                    <div class="ambient-btn" onclick="setAmbient('rain', this)" data-i18n="ambient_rain">빗소리</div>
                </div>
            </div>
            <div id="timer-success" style="display: none; flex-direction: column; align-items: center; width:100%;">
                <div class="small-label" data-i18n="label_success">비움 완료</div>
                <div style="font-size: 1.4rem; margin: 40px 0; font-weight: 200;" data-i18n="timer_done">공간이 한결 가벼워졌습니다.
                </div>
                <input type="text" id="t-input" class="input-line" data-i18n-placeholder="timer_placeholder"
                    placeholder="무엇을 비웠나요?">
                <button class="btn-link" onclick="finishTimerRitual()" style="margin-top:40px;"
                    data-i18n="save_archive">기록 보관소에 저장</button>
            </div>
        </div>

        <div id="screen-pause" class="screen">
            <div id="pause-content" style="width:100%;">
                <div class="small-label" data-i18n="label_pause">의도적 멈춤</div>
                <input type="text" id="p-input" class="input-line" data-i18n-placeholder="pause_placeholder"
                    placeholder="무엇을 사고 싶나요?">
                <!-- New Cost Input -->
                <input type="number" id="p-price" class="input-line" data-i18n-placeholder="pause_cost"
                    placeholder="예상 가격은 얼마인가요? (선택)" style="margin-top: 20px; font-size: 1rem; opacity: 0.7;">

                <button class="btn-link" onclick="savePurchase()" style="margin-top:50px;" data-i18n="pause_start">24시간
                    유예하기</button>
            </div>
            <div id="pause-success" style="display: none; flex-direction: column; align-items: center;">
                <div style="font-size: 1.4rem; color: var(--text-muted); margin-bottom: 30px; font-weight: 200;"
                    data-i18n="inner_calm">내면의 고요</div>
                <div style="font-size: 1rem; color: var(--text-dim); line-height: 2;" data-i18n="pause_done">충동이 가라앉을
                    때까지<br>24시간의 유예 시간을 가집니다.</div>
                <button class="btn-link" onclick="goToScreen('home')" style="margin-top: 60px; font-size: 0.9rem;"
                    data-i18n="back_home">홈으로 돌아가기</button>
            </div>
        </div>

        <div id="screen-archive" class="screen">
            <div class="small-label" data-i18n="home_archive">기록 보관소</div>
            <div id="weight-stat"
                style="font-size: 0.8rem; color: var(--text-dim); margin-bottom: 20px; font-family: var(--font-sans); letter-spacing: 0.1em;">
            </div>
            <!-- Savings Stat -->
            <div id="savings-stat"
                style="font-size: 0.75rem; color: var(--accent-color); margin-bottom: 40px; font-family: var(--font-sans); letter-spacing: 0.1em; opacity: 0.8;">
            </div>

            <div class="archive-list" id="archive-content"></div>

            <div style="margin-top: 30px; display: flex; gap: 20px;">
                <button class="btn-link" onclick="exportData()" style="font-size: 0.8rem; opacity: 0.5;"
                    data-i18n="btn_backup">백업</button>
                <button class="btn-link" onclick="document.getElementById('import-file').click()"
                    style="font-size: 0.8rem; opacity: 0.5;" data-i18n="btn_restore">복원</button>
                <input type="file" id="import-file" style="display: none;" onchange="importData(this)" accept=".json">
            </div>
        </div>

        <div id="toast">기록되었습니다</div>
        <div id="deep-fade-overlay"></div>
    </div>

    <script src="challenges.js"></script>
    <script src="app.js"></script>
</body>

</html>